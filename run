from Library.FrameWork.FW_upgrades import runner
from Library.Excel.TestData import load_test_data_and_get_TCIDs

# Mandatory Variables
EXCEL_PATH = "C:\\SeleniumPython_FW\\Data\\data.xlsx"
SHEET_NAME = "data"
Apprun = "web"                      # eg:  "electron" or "web"
ENVIRONMENT = "opensource-demo"     # eg:  "qa" or "dev"

# Initialize runner with Excel config
run = runner(excel_path=EXCEL_PATH, sheet_name=SHEET_NAME)
#run = runner(excel_path=EXCEL_PATH, sheet_name=SHEET_NAME, detach_browser=True)

# Load test data
List_of_TC_to_Execute = load_test_data_and_get_TCIDs(EXCEL_PATH, SHEET_NAME)
print("✅ Y-flagged Test Cases:", List_of_TC_to_Execute)

# Run suite and update results
if List_of_TC_to_Execute:
    run.start_suite(suite="TestSuite", testcases=List_of_TC_to_Execute, apprun=Apprun, env=ENVIRONMENT)
    #run = runner(excel_path=EXCEL_PATH, sheet_name=SHEET_NAME, detach_browser=True)
else:
    print("⚠️ No Y-flagged test cases found.")
